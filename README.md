# 自動點擊工具 (Auto Clicker)

一個功能完善的 Python 自動滑鼠點擊工具,支援 GUI 介面控制、座標擷取、統計資訊顯示等功能,適用於遊戲輔助、自動化測試等場景。

## 功能特色

- ✅ **圖形化介面** - 使用 tkinter 建立的友善 GUI 介面
- ✅ **座標擷取** - 點擊按鈕後可直接在螢幕上選取目標位置
- ✅ **可調整間隔** - 支援設定點擊間隔時間 (0.01-10 秒)
- ✅ **統計資訊** - 即時顯示已點擊次數與運行時間
- ✅ **全域熱鍵** - 按 F9 暫停/恢復,按 ESC 緊急停止
- ✅ **視窗置頂** - 視窗始終保持在最上層,方便操作
- ✅ **設定管理** - 可儲存/載入常用的座標和參數設定
- ✨ **多桌面支援 (macOS)** - 視窗固定在開啟時的桌面,點擊不會干擾其他桌面
- 🆕 **自動停止** - 可設定點擊次數上限,達到後自動停止
- 🆕 **緊急停止熱鍵** - 按 ESC 立即停止點擊,無需移動滑鼠

## 系統需求

- **作業系統**: macOS / Windows / Linux
- **Python 版本**: Python 3.7 或以上
- **依賴套件**:
  - `pyautogui` - 滑鼠控制
  - `keyboard` - 全域熱鍵監聽

## 安裝步驟

### 1. 下載專案

將專案檔案下載到本機,或使用 Git clone:

```bash
cd ~/Desktop
# 專案已經在 auto_clicker 資料夾中
```

### 2. 安裝依賴套件

```bash
pip3 install pyautogui keyboard
```

**注意**: 在 macOS 上,`keyboard` 套件需要輔助功能權限,請在「系統偏好設定 > 安全性與隱私權 > 輔助使用」中允許終端機或 Python 存取。

### 3. 執行程式

```bash
cd ~/Desktop/auto_clicker
python3 auto_clicker.py
```

或直接雙擊 `auto_clicker.py` 檔案執行。

## 使用說明

### 基本操作流程

1. **設定座標**
   - 方法一:直接在「X 座標」和「Y 座標」欄位輸入數值
   - 方法二:點擊「選取座標」按鈕,然後在螢幕上點擊目標位置

2. **設定點擊間隔**
   - 在「點擊間隔」欄位輸入秒數 (例如 0.5 表示每 0.5 秒點擊一次)

3. **開始點擊**
   - 點擊「開始點擊」按鈕,程式將開始在指定座標自動點擊
   - 統計資訊會即時更新顯示點擊次數和運行時間

4. **停止點擊**
   - 點擊「停止」按鈕,或按 F9 鍵暫停/恢復

5. **儲存/載入設定**
   - 點擊「儲存設定」將當前參數存入 `config.json`
   - 點擊「載入設定」從 `config.json` 讀取先前儲存的設定
   - 程式啟動時會自動載入上次的設定

### 快捷鍵

| 熱鍵  | 功能           | 說明                                     |
| ----- | -------------- | ---------------------------------------- |
| **F9**  | 暫停/恢復      | 暫停自動點擊,再按一次恢復                |
| **ESC** | 緊急停止 🆕    | 立即完全停止點擊,重置程式狀態            |

**注意**: 全域熱鍵在任何視窗下都有效,即使滑鼠正在點擊目標位置也能使用

### GUI 介面說明

```
┌─────────────────────────────────────────────────────┐
│ 自動點擊工具 - Auto Clicker (桌面固定)        [置頂] │
├─────────────────────────────────────────────────────┤
│  【座標設定】                                        │
│  X 座標: [____100____]  Y 座標: [____200__]         │
│  [選取座標]                                          │
│                                                     │
│  【參數設定】                                        │
│  點擊間隔: [___0.5___] 秒                            │
│  點擊上限: [___100___] 次 (0=無限) 🆕                │
│                                                     │
│  【控制區】                                          │
│  [開始點擊]  [停止]  [儲存設定]  [載入設定]          │
│                                                     │
│  【統計資訊】                                        │
│  已點擊次數: 1,234 次                                │
│  運行時間: 00:05:32                                  │
│                                                     │
│  提示: 按 F9 暫停/恢復 | 按 ESC 緊急停止 🆕          │
└─────────────────────────────────────────────────────┘
```

### 🖥️ macOS 多桌面功能說明 (NEW!)

在 macOS 上,如果您使用 Mission Control 的多個桌面 (Spaces) 功能,本工具提供了特殊的支援:

#### 功能特性

1. **視窗固定在單一桌面**
   - 程式視窗只會出現在您開啟程式時的桌面
   - 不會跟隨到其他桌面,避免干擾其他工作空間

2. **智慧點擊控制**
   - 當您切換到其他桌面時,自動點擊會繼續運行但不會干擾其他桌面
   - 點擊動作只在程式所在的桌面執行
   - 回到程式所在桌面時,點擊會正常進行

3. **無縫工作流程**
   - 您可以在其他桌面進行其他工作,不受自動點擊影響
   - 不需要手動暫停或停止程式

#### 使用範例

```
桌面 1: 執行自動點擊工具,設定在遊戲視窗點擊
桌面 2: 切換到此處理工作或瀏覽網頁
        → 自動點擊不會干擾桌面 2 的操作
桌面 1: 切換回來,自動點擊正常執行
```

#### 技術實現

- 使用 macOS 原生 API (AppKit/NSWorkspace) 偵測桌面狀態
- 自動判斷程式是否在當前活躍的桌面
- 僅在正確的桌面執行點擊動作

#### 注意事項

- 此功能僅在 macOS 上啟用
- Windows/Linux 系統使用傳統的全域置頂模式
- 需要安裝 `pyobjc-framework-Cocoa` (已自動包含在依賴中)

## 設定檔格式

程式會在同目錄下建立 `config.json` 檔案,格式如下:

```json
{
    "x": 100,
    "y": 200,
    "interval": 0.5,
    "max_clicks": 100,
    "last_updated": "2025-11-12 12:30:45"
}
```

**參數說明**:
- `x`, `y`: 點擊座標
- `interval`: 點擊間隔(秒)
- `max_clicks`: 點擊上限次數 (0=無限) 🆕
- `last_updated`: 最後更新時間

## 技術架構

### 核心模組

1. **ConfigManager** - 設定檔管理
   - 儲存/載入 JSON 格式的設定檔

2. **StatisticsTracker** - 統計追蹤
   - 計數點擊次數
   - 計算運行時間

3. **ClickController** - 點擊控制
   - 管理自動點擊執行緒
   - 處理暫停/恢復邏輯
   - 整合桌面狀態檢查

4. **CoordinateCapture** - 座標擷取
   - 捕捉使用者點擊位置

5. **DesktopMonitor** - 桌面監控 (macOS)
   - 偵測程式所在桌面
   - 判斷是否在當前活躍桌面

6. **AutoClickerGUI** - 圖形介面
   - 整合所有模組
   - 處理使用者互動

### 技術棧

| 功能           | 技術/函式庫         |
| -------------- | ------------------- |
| GUI 框架       | tkinter             |
| 滑鼠控制       | pyautogui           |
| 熱鍵監聽       | keyboard            |
| 多執行緒       | threading           |
| 設定檔         | JSON                |
| macOS API 整合 | pyobjc-framework-Cocoa |

## 常見問題

### Q1: macOS 上提示「需要輔助功能權限」怎麼辦?

**解答**:
1. 開啟「系統偏好設定」
2. 進入「安全性與隱私權」
3. 選擇「輔助使用」標籤
4. 解鎖並勾選「終端機」或「Python」
5. 重新執行程式

### Q2: F9 熱鍵沒有反應?

**解答**:
- 確認 `keyboard` 套件已正確安裝
- 在 macOS 上需要授予輔助功能權限
- 某些遊戲可能會攔截全域熱鍵,請嘗試切換到桌面再按 F9

### Q3: 點擊座標不準確?

**解答**:
- 使用「選取座標」功能可以更精確地選取位置
- 確認顯示器解析度設定正確
- 在多螢幕環境下,座標可能會受到影響

### Q4: 如何停止程式?

**解答**:
- 點擊視窗上的「停止」按鈕
- 按 F9 鍵暫停點擊
- 關閉視窗即可退出程式

### Q5: 可以同時點擊多個位置嗎?

**解答**: 當前版本僅支援單一固定位置點擊。如需多點輪流點擊功能,請聯繫開發者或自行修改程式碼。

### Q6: macOS 多桌面功能如何運作? (NEW!)

**解答**:
- 程式會自動偵測是否在 macOS 上運行
- 視窗只會固定在開啟時的桌面,不會出現在其他桌面
- 當您切換到其他桌面時,點擊動作會自動跳過,不會干擾其他桌面
- 回到程式所在桌面時,點擊會自動恢復正常執行
- 這個功能完全自動化,不需要手動設定

### Q7: 切換桌面後,為什麼點擊次數沒有增加?

**解答**: 這是正常行為!當您在其他桌面時,程式會偵測到並跳過點擊動作,所以點擊次數不會增加。這樣可以確保自動點擊只在程式所在的桌面執行,不會干擾您在其他桌面的工作。回到程式所在桌面後,點擊會自動恢復。

### Q8: 滑鼠一直在點擊目標位置,無法點到停止按鈕怎麼辦? 🆕

**解答**: 這個問題已經解決!現在有多種方式可以停止點擊:
1. **按 ESC 鍵** - 最快速的方法,立即緊急停止點擊 (推薦)
2. **按 F9 鍵** - 先暫停點擊,然後移動滑鼠到視窗點「停止」按鈕
3. **設定點擊上限** - 在「點擊上限」欄位輸入次數,達到後自動停止
4. **關閉視窗** - 直接關閉程式視窗

### Q9: 如何設定自動停止?點擊上限怎麼用? 🆕

**解答**:
- 在「點擊上限」欄位輸入想要的點擊次數(例如 100)
- 設定為 0 表示無限點擊,不會自動停止
- 達到設定的次數後,程式會自動停止並顯示提示訊息
- 適合用於需要固定次數點擊的場景

### Q10: ESC 熱鍵按了沒反應? 🆕

**解答**:
- 確認 `keyboard` 套件已正確安裝
- 在 macOS 上需要授予輔助功能權限(與 F9 相同)
- 某些全螢幕遊戲可能會攔截 ESC 鍵,此時可以:
  - 先按 Command+Tab 切換到桌面
  - 然後按 ESC 或 F9 停止程式

## 注意事項

1. **使用限制**
   - 本工具僅供學習、測試和個人使用
   - 請勿用於違反遊戲服務條款的行為
   - 使用本工具造成的任何後果由使用者自行承擔

2. **效能建議**
   - 建議點擊間隔不要小於 0.01 秒,以免造成系統負擔
   - 長時間運行時請適時檢查系統資源使用情況

3. **權限需求**
   - macOS 需要授予「輔助使用」權限
   - Windows 可能需要以系統管理員身分執行

## 專案檔案結構

```
auto_clicker/
├── auto_clicker.py    # 主程式
├── config.json        # 設定檔 (自動生成)
└── README.md          # 使用說明
```

## 版本資訊

- **版本**: v1.0.0
- **最後更新**: 2025-11-12
- **開發語言**: Python 3
- **授權**: MIT License

## 回饋與支援

如有任何問題或建議,歡迎提出回饋。

---

**開發提醒**: 本工具使用了 GUI 和全域熱鍵功能,請確保您的系統已授予必要的權限。
